island == "Molhadhoo" & atoll_official == "Haa Alif Atoll" ~ "Mulhadhoo",
island == "Inguraidhoo" & atoll_official == "Raa Atoll" ~ "Iguraidhoo",
island == "Ungoofaaru" & atoll_official == "Raa Atoll" ~ "Ugoofaaru",
island == "Hulhudhoo	" & atoll_official == "Seenu Atoll" ~ "Hulhumeedhoo",
island == "Kanditheemu" & atoll_official == "Shaviyani Atoll" ~ "Kaditheemu",
island == "Kinbidhoo" & atoll_official == "Thaa Atoll" ~ "Kibidhoo",
island %in% c("Nolhivaran", "Nolhivaramu") &
atoll_official == "Haa Dhaal Atoll" ~ "Nolhivaram",
island == "Angolhitheemu" ~ "Agolhitheemu",
island %in% c("Meedhoo", "Hulhudhoo") ~ "Hulhumeedhoo",
island == "Dhonfan" ~ "Dhonfanu",
island == "Mundoo" & atoll_official == "Laamu Atoll" ~ "Mundhoo",
island == "Raiymandhoo" & atoll_official == "Meemu Atoll" ~ "Raimandhoo",
str_detect(island, "Kedhikolhudhoo") & atoll_official == "Noonu Atoll" ~ "Kendhikulhudhoo",
island == "Bilehfahi" & atoll_official == "Shaviyani Atoll" ~ "Bilehffahi",
island == "Maaugoodhoo" & atoll_official == "Shaviyani Atoll" ~ "Maaungoodhoo",
island == "Kadoodhoo" & atoll_official == "Thaa Atoll" ~ "Kandoodhoo",
island == "Hoadedhdhoo" & atoll_official == "Gaaf Dhaal Atoll" ~ "Hoandedhdhoo",
island == "Foammulah" & atoll_official == "Gnaviyani Atoll" ~ "Fuvahmulah",
island == "Kadoodhoo" & atoll_official == "Thaa Atoll" ~ "Kandoodhoo",
island == "Madeveli" & atoll_official == "Gaaf Dhaal Atoll" ~ "Madaveli",
island == "Rinbudhoo" & atoll_official == "Dhaal Atoll" ~ "Ribudhoo",
island == "Kondey" ~ "Kodey",
TRUE ~ island
)) |>
left_join(
atolls_official |>
distinct(atoll_official = Atoll, atoll_official_name = `Atoll Official Name`),
by = "atoll_official"
) |>
mutate(atoll_official_name = ifelse(atoll_official == "Greater Male Region",
atoll_official,
atoll_official_name)) |>
rename(value = data_value) |>
select(-normalized_value, -sort_order) |>
rbind(
tribble(
~dataset, ~indicator, ~atoll_official, ~island, ~value,
"Population", "Population", "Greater Male Region", "Hulhule", 80,
"Population", "Population", "Greater Male Region", "Hulhumale'", 53193,
"Population", "Population", "Greater Male Region", "Male'", 211908,
"Population", "Population", "Greater Male Region","Vilimale'", 6754,
"Population", "Population", "Haa Dhaal Atoll", "Kalhaidhoo", 10398,
"Population", "Population density", "Greater Male Region", "Male'", 17500,
"Population", "Population density", "Greater Male Region","Vilimale'", 25000,
"Population", "Population density", "Greater Male Region", "Hulhumale'", 18184) |>
mutate(atoll_official_name = atoll_official)
) |>
# adm1_match
left_join(
adm1_match |>
select(atoll_official, adm1_pcode, local_names),
by = "atoll_official"
) |>
mutate(adm1_pcode = ifelse(atoll_official_name == "Greater Male Region",
"MV021",
adm1_pcode)) |>
group_by(adm1_pcode, island) |>
mutate(population = ifelse(indicator == "Population", value, NA_integer_)) |>
fill(population, .direction = c("downup")) |>
ungroup() |>
mutate(atoll_official_name = ifelse(atoll_official_name == "Haa Dhaal Atoll",
"Thiladhunmathee Dhekunuburi",
atoll_official_name)) |>
mutate(value = ifelse(indicator %out% not_per_capita_list,
value / population * 100000,
value),
indicator = ifelse(indicator %out% not_per_capita_list,
paste0(indicator, " per 100k persons"),
indicator)) |>
# I think you need to move these to write
# mutate(indicator2 = indicator, value2 = value) |>
distinct(dataset, indicator, atoll_official, island, adm1_pcode,
value, atoll_official_name, local_names, population)  #, indicator2, value2
adm2_match <- islands |>
distinct(adm1_pcode, atoll_official, island) |>
left_join(
maldives_shape |>
st_drop_geometry() |>
distinct(adm2_en, adm2_pcode, adm1_pcode) |>
mutate(adm2_en_alt = str_remove_all(adm2_en, "\\'")) |>
mutate(adm2_en_alt = case_when(
adm1_pcode == "MV001" & adm2_en == "Thuraakunu" ~ "Thurakunu",
adm1_pcode == "MV001" & adm2_en == "Dhihdhoo" ~ "Dhidhdhoo",
adm1_pcode == "MV001" & adm2_en == "Huvarafushi" ~ "Hoarafushi",
adm1_pcode == "MV001" & adm2_en == "Uligamu" ~ "Uligan",
adm1_pcode == "MV002" & adm2_en == "Kulhudhuffushi" ~ "Kalhaidhoo",
adm1_pcode == "MV002" & adm2_en == "Kun'burudhoo" ~ "Kunburudoo",
adm1_pcode == "MV002" & adm2_en == "Kurin'bee" ~ "Kurinbi",
adm1_pcode == "MV002" & adm2_en == "Nolhivaramu" ~ "Nolhivaram",
adm1_pcode == "MV002" & adm2_en == "Nolhivaranfaru" ~ "Nolhivaramfaru",
adm1_pcode == "MV003" & str_detect(adm2_en, "Kin'bidhoo") ~ "Kibidhoo",
adm1_pcode == "MV003" & adm2_en == "Bileiyfahi" ~ "Bilehffahi",
adm1_pcode == "MV003" & str_detect(adm2_en, "Kan'ditheemu") ~ "Kaditheemu",
adm1_pcode == "MV003" & str_detect(adm2_en, "Maakan'doodhoo") ~ "Maakandoodhoo",
adm1_pcode == "MV003" & str_detect(adm2_en, "Maaun'goodhoo") ~ "Maaungoodhoo",
adm1_pcode == "MV004" & adm2_en == "Fohdhoo" ~ "Fodhdhoo",
adm1_pcode == "MV004" & adm2_en == "Hen'badhoo" ~ "Hebadhoo",
adm1_pcode == "MV004" & str_detect(adm2_en, "dhikulhudhoo") ~ "Kedhikolhudhoo",
adm1_pcode == "MV006" & adm2_en == "An'golhitheemu" ~ "Agolhitheemu",
adm1_pcode == "MV006" & adm2_en == "In'guraidhoo" ~ "Iguraidhoo",
adm1_pcode == "MV006" & adm2_en == "Hulhudhoo" ~ "Hulhumeedhoo",
adm1_pcode == "MV006" & adm2_en == "Un'goofaaru" ~ "Ugoofaaru",
adm1_pcode == "MV006" & str_detect(adm2_en, "Kan'dholhudhoo") ~ "Kandholhudhoo",
adm1_pcode == "MV007" & adm2_en == "MV007007" ~ "Maalhos",
adm1_pcode == "MV008" & adm2_en == "Himendhoo" ~ "Himandhoo",
adm1_pcode == "MV009" & adm2_en == "Hinmafushi" ~ "Himmafushi",
adm1_pcode == "MV011" & adm2_en == "Bileiydhoo" ~ "Biledhdhoo",
adm1_pcode == "MV011" & adm2_en == "Dharan'boodhoo" ~ "Dharaboodhoo",
adm1_pcode == "MV012" & adm2_en == "Ban'didhoo" ~ "Badidhoo",
adm1_pcode == "MV012" & adm2_en == "Maaen'boodhoo" ~ "Maaeboodhoo",
adm1_pcode == "MV012" & adm2_en == "Meedhoo" ~ "Hulhumeedhoo",
adm1_pcode == "MV012" & str_detect(adm2_en, "Rin'budhoo") ~ "Ribudhoo",
adm1_pcode == "MV013" & adm2_en == "Raiymandhoo" ~ "Raimandhoo",
adm1_pcode == "MV014" & adm2_en == "Burunee" ~ "Buruni",
adm1_pcode == "MV014" & str_detect(adm2_en, "Kan'doodhoo") ~ "Kandoodhoo",
adm1_pcode == "MV014" & str_detect(adm2_en, "Kin'bidhoo") ~ "Kibidhoo",
adm1_pcode == "MV015" & adm2_en == "Dhan'bidhoo" ~ "Dhabidhoo",
adm1_pcode == "MV015" & adm2_en == "Mundoo" ~ "Mundhoo",
adm1_pcode == "MV016" & adm2_en == "Kon'dey" ~ "Kodey",
adm1_pcode == "MV016" & adm2_en == "Vilin'gili" ~ "Viligili",
adm1_pcode == "MV016" & adm2_en == "Kon'dey" ~ "Kodey",
adm1_pcode == "MV016" & adm2_en == "Kan'duhulhudhoo" ~ "Kanduhulhudhoo",
adm1_pcode == "MV017" & adm2_en == "Faresmaathodaa" ~ "Fares-Maathodaa",
adm1_pcode == "MV017" & adm2_en == "Gahdhoo" ~ "Gadhdhoo",
adm1_pcode == "MV017" & adm2_en == "Hoadehdhoo" ~ "Hoandedhdhoo",
adm1_pcode == "MV017" & adm2_en == "Nadellaa" ~ "Nadallaa",
adm1_pcode == "MV019" & adm2_en == "Meedhoo" ~ "Hulhumeedhoo",
adm1_pcode == "MV019" & adm2_en == "Maradhoofeydhoo" ~ "Maradhoo-Feydhoo",
adm1_pcode == "MV020" & adm2_en == "Hangnaameedhoo" ~ "Hanghghaameedhoo",
adm1_pcode == "MV020" & adm2_en == "Dhihdhoo" ~ "Dhidhdhoo",
adm1_pcode == "MV020" & adm2_pcode == "MV020006" ~ "Dhangethi",
adm1_pcode == "MV020" & adm2_en == "Maamin'gili" ~ "Maamigili",
TRUE ~ adm2_en)),
by = c("island" = "adm2_en_alt", "adm1_pcode")
) |>
mutate(adm2_pcode = case_when(
adm1_pcode == "MV021" & str_detect(island, "Male'") ~ "MV021001",
adm1_pcode == "MV021" & str_detect(island, "Hulhumale'") ~ "MV021003",
adm1_pcode == "MV021" & str_detect(island, "Vilimale'") ~ "MV021002",
atoll_official == "Haa Alif Atoll" & str_detect(island, "Uligamu") ~ "MV001002",
atoll_official == "Haa Dhaal Atoll" & str_detect(island, "Kulhudhuffushi") ~ "MV002012",
atoll_official == "Baa Atoll" & str_detect(island, "Maalhoss") ~ "MV007007",
atoll_official == "Alif Uthuru Buri" & str_detect(island, "Maalhoss") ~ "MV008007",
atoll_official == "Laamu Atoll" & str_detect(island, "Gamu") ~ "MV015013",
atoll_official == "Noonu Atoll" & str_detect(island, "Kendhikulhudhoo") ~ "MV004002",
adm1_pcode == "MV020" & str_detect(island, "Kunburudhoo") ~ "MV020003",
TRUE ~ adm2_pcode
)) |>
mutate(adm2_en = ifelse(island == "Gamu", "Gan", adm2_en)) |>
filter(atoll_official != "Greater Male Region" | island != "Hulhule") |>
filter(atoll_official != "Lammu Atoll" | island != "Gan") |>
arrange(adm1_pcode)
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index") |>
filter(is.na(local_names))
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index")  |>
glimpse()
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI")) |>
glimpse()
islands |>
left_join(
adm2_match |>
select(adm1_pcode, island, adm2_pcode),
by = c("adm1_pcode", "island")
) |>
# hulhule gets dropped
filter(!is.na(adm2_pcode)) |>
select(-population) |> glimpse()
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official,
atoll_official_name),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range, island,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI")) |>
glimpse()
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official,
atoll_official_name),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range, island,
atoll_official_names,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI")) |>
glimpse()
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official,
atoll_official_name),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range, island,
atoll_official_name,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI")) |>
glimpse()
islands |>
left_join(
adm2_match |>
select(adm1_pcode, island, adm2_pcode),
by = c("adm1_pcode", "island")
) |>
# hulhule gets dropped
filter(!is.na(adm2_pcode)) |>
select(-population) |>
rbind(
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official,
atoll_official_name),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range, island,
atoll_official_name,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI"))
)
islands_rwi <- islands |>
left_join(
adm2_match |>
select(adm1_pcode, island, adm2_pcode),
by = c("adm1_pcode", "island")
) |>
# hulhule gets dropped
filter(!is.na(adm2_pcode)) |>
select(-population) |>
rbind(
rwi_matched |>
mutate(rwi_range = range_wna(rwi)) |>
left_join(adm1_match |>
select(adm1_pcode, local_names, atoll_official,
atoll_official_name),
by = "adm1_pcode") |>
left_join(adm2_match |>
select(island, adm2_pcode),
by = "adm2_pcode") |>
select(adm1_pcode, adm2_pcode, rwi, rwi_range, island,
atoll_official_name,
local_names, atoll_official, adm2_pcode) |>
pivot_longer(cols = c(rwi_range, rwi),
names_to = "indicator",
values_to = "value") |>
mutate(dataset = "Relative Wealth Index",
indicator = ifelse(indicator == "rwi_range",
"RWI range", "RWI"))
)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx")) |>
```
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx")) |> glimpse(
)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names()
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |> glimpse()
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01) |>
glimpse()
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
administration_level) |>
glimpse()
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
glimpse()
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
count(population, indicator)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
count(population, indicator)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |> glimpse()
count(population, indicator, administration)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
count(population, indicator, administration)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
filter(administration != "Non Administrative Islands")
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
filter(administration != "Non Administrative Islands") |>
count(atoll_official)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
mutate(administration = case_when(
administration == "Administrative Islands & Non-administrative Islands" ~
"Administrative & Non-administrative Islands",
administration == "Non Administrative Islands" ~
"Non-administrative Islands",
TRUE ~ administration
)) |>
mutate(atoll_official = case_when(
atoll_official == "GNAVIYANI Atoll" ~ "Gnaviyani Atoll",
atoll_official == "LHAVIYANI Atoll" ~ "Lhaviyani Atoll",
str_detect(atoll_official, "Male") ~ "Greater Male Region",
atoll_official == "NOONU Atoll" ~ "Noonu Atoll",
atoll_local_names == "Addu (S)" ~ "Seenu Atoll",
TRUE ~ atoll_official
)) |>
count(atoll_official)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
mutate(administration = case_when(
administration == "Administrative Islands & Non-administrative Islands" ~
"Administrative & Non-administrative Islands",
administration == "Non Administrative Islands" ~
"Non-administrative Islands",
TRUE ~ administration
)) |>
mutate(atoll_official = case_when(
atoll_official == "GNAVIYANI Atoll" ~ "Gnaviyani Atoll",
atoll_official == "LHAVIYANI Atoll" ~ "Lhaviyani Atoll",
str_detect(atoll_official, "Male") ~ "Greater Male Region",
atoll_official == "NOONU Atoll" ~ "Noonu Atoll",
atoll_local_names == "Addu (S)" ~ "Seenu Atoll",
TRUE ~ atoll_official
)) |>
filter(atoll_official == "Greater Male Region")
islands |> filter(atoll_official == "Greater Male Region")
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
mutate(administration = case_when(
administration == "Administrative Islands & Non-administrative Islands" ~
"Administrative & Non-administrative Islands",
administration == "Non Administrative Islands" ~
"Non-administrative Islands",
TRUE ~ administration
)) |>
mutate(atoll_official = case_when(
atoll_official == "GNAVIYANI Atoll" ~ "Gnaviyani Atoll",
atoll_official == "LHAVIYANI Atoll" ~ "Lhaviyani Atoll",
str_detect(atoll_official, "Male") ~ "Greater Male Region",
atoll_official == "NOONU Atoll" ~ "Noonu Atoll",
atoll_local_names == "Addu (S)" ~ "Seenu Atoll",
TRUE ~ atoll_official
)) |>
count(population, indicator, administration)
read_excel(here("data", "Combined Datasets - Latest - Copy-DESKTOP-BNB4CL0.xlsx"),
sheet = 2) |>
clean_names() |>
filter(administration_level == "admin2") |>
select(-min, -max, -normalized_value, -sort_order, -sort1, -range01,
-administration_level) |>
mutate(population = ifelse(population == "Provisionally Resident Population",
"Resident Population",
population)) |>
mutate(administration = case_when(
administration == "Administrative Islands & Non-administrative Islands" ~
"Administrative & Non-administrative Islands",
administration == "Non Administrative Islands" ~
"Non-administrative Islands",
TRUE ~ administration
)) |>
mutate(atoll_official = case_when(
atoll_official == "GNAVIYANI Atoll" ~ "Gnaviyani Atoll",
atoll_official == "LHAVIYANI Atoll" ~ "Lhaviyani Atoll",
str_detect(atoll_official, "Male") ~ "Greater Male Region",
atoll_official == "NOONU Atoll" ~ "Noonu Atoll",
atoll_local_names == "Addu (S)" ~ "Seenu Atoll",
TRUE ~ atoll_official
)) |>
filter(indicator == "Reported Crimes")
