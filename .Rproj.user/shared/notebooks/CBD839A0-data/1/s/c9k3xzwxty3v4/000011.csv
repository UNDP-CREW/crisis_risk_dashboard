"0","migrant_stock_changes |> 
  group_by(area_of_origin, sex) |> 
  summarise(origin_population_2020 = mean(origin_population_2020), 
            migrants_2020 = sum(migrants_2020)) |> 
  mutate(migrants_pc = migrants_2020 / origin_population_2020 * 100) |> 
  arrange(desc(migrants_pc)) |> 
  filter(area_of_origin %in% country_list) |> 
  group_by(area_of_origin) |> 
  mutate(total_migrants_sort = sum(migrants_2020), 
         total_migrants_pc = total_migrants_sort / origin_population_2020) |> 
  
  ungroup() |> 
  mutate(area_of_origin = fct_reorder(area_of_origin, total_migrants_pc), 
         sex = str_to_title(sex)) |> 
  ggplot(aes(x = migrants_2020, y = area_of_origin)) + 
  geom_col(aes(fill = migrants_pc)) +
  geom_text(aes(label = comma(migrants_2020)), 
            size = 3, 
            hjust = ""inward"") + 
  scale_fill_viridis(direction = -1, end= .95) +
  scale_x_continuous(labels = number_format(scale = 1 / 1000000, suffix = ""M"")) + 
  facet_row(vars(sex), scales = ""free_x"", space = ""free"") + 
  labs(title = ""Number of persons who migrated, by country of origin, 2020"", 
       subtitle = ""Colour shows % of country population have migrated"", 
       fill = ""% Migrated"", 
       y = """", 
       x = ""Number of migrants 2020"", 
       caption = ""Source: International Migrant Stock 2020"") + 
  theme(legend.position = c(.9, .7), 
        strip.background = element_rect(fill = ""black""))
"
"1","[38;5;238m`summarise()` has grouped output by 'area_of_origin'. You can override using the `.groups` argument.[39m
"
