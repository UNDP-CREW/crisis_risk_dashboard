"0","hrd |> 
  filter(str_detect(date_added, ""2023"")) |> 
  separate(violation, sep = ""\\|"", remove = FALSE, 
           into = paste0(""violation"", 1:7)) |> 
  pivot_longer(cols = violation1:violation7,
               names_to = ""ignore"",
               values_to = ""violation_long"") |> 
  filter(!is.na(violation_long)) |> 
  group_by(violation_long) |> 
  summarise(event_count = n_distinct(serial_number), 
            average_impact = mean(impact_of_event, na.rm = TRUE), 
            .groups = ""drop"") |> 
  write_csv(here(""data"", ""hrd_violation_chart.csv""))
"
"2","Warning:"
"2"," [38;5;238mExpected 7 pieces. Missing pieces filled with `NA` in 289 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
16, 17, 18, 19, 20, ...].[39m
"
